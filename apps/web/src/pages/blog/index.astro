---
import { getCollection } from "astro:content";
import CategoryFilter from "@/components/CategoryFilter.astro";
import Container from "@/components/Container.astro";
import PostCard from "@/components/PostCard.astro";
import Layout from "@/layouts/Layout.astro";
import { SITE } from "@/lib/constants/site";

const posts = await getCollection("posts");
const categories = await getCollection("categories");
const fillers = Array.from({ length: (3 - (posts.length % 3)) % 3 });
---

<Layout
  title={`Blog - ${SITE.TITLE}`}
  description="Bits and pieces about SEO and content writing."
>
  <section class="lg:border-y border-dashed min-h-[calc(100vh-140px)]">
    <div
      class="lg:border-x border-dashed md:w-[calc(100%-140px)] mx-auto h-full"
    >
      <Container class="py-20 lg:py-24 h-full">
        <div
          class="mb-16 flex flex-col items-start gap-4 md:flex-row md:items-end md:justify-between"
        >
          <div class="space-y-4">
            <h1
              class="text-2xl tracking-tight md:text-3xl lg:text-4xl font-medium"
            >
              Blog
            </h1>
            <p class="max-w-prose md:text-lg text-muted-foreground">
              Updates, news, and articles from Marble.
            </p>
          </div>
          <div class="w-full md:w-auto">
            <CategoryFilter categories={categories} />
          </div>
        </div>
        <ul
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 border-t border-l border-dashed"
        >
          {posts.map((post) => (
              <PostCard entry={post} />
            ))}
          {fillers.map(() => (
            <li class="border-b border-r border-dashed bg-white hidden md:block h-full" />
          ))}
        </ul>
      </Container>
    </div>
  </section>
</Layout>
